# HDMI Matrix Proxy - Lovelace Dashboard Card
# Paste this into a Manual Card in your Lovelace dashboard

type: vertical-stack
cards:
  # Status and Health
  - type: entities
    title: HDMI Matrix Status
    show_header_toggle: false
    entities:
      - entity: sensor.hdmi_matrix_status
        name: Connection Status
        icon: mdi:lan-connect
      - entity: sensor.hdmi_matrix_health
        name: Health
        icon: mdi:heart-pulse
      - type: attribute
        entity: sensor.hdmi_matrix_health
        attribute: uptime_seconds
        name: Uptime (seconds)
        icon: mdi:clock-outline

  # Routing Control (view current routing and change it)
  - type: entities
    title: Routing Control
    show_header_toggle: false
    entities:
      - entity: input_select.matrix_output_1_source
        name: Output 1
        icon: mdi:television
      - entity: input_select.matrix_output_2_source
        name: Output 2
        icon: mdi:television
      - entity: input_select.matrix_output_3_source
        name: Output 3
        icon: mdi:television
      - entity: input_select.matrix_output_4_source
        name: Output 4
        icon: mdi:television
      - entity: input_select.matrix_output_5_source
        name: Output 5
        icon: mdi:television
      - entity: input_select.matrix_output_6_source
        name: Output 6
        icon: mdi:television
      - entity: input_select.matrix_output_7_source
        name: Output 7
        icon: mdi:television
      - entity: input_select.matrix_output_8_source
        name: Output 8
        icon: mdi:television
  
  # Current Routing Info (for reference)
  - type: markdown
    content: |
      {% set outputs = state_attr('sensor.hdmi_matrix_routing', 'outputs') %}
      {% set input_names = state_attr('sensor.hdmi_matrix_routing', 'input_names') %}
      {% set output_names = state_attr('sensor.hdmi_matrix_routing', 'output_names') %}
      {% if outputs and input_names and output_names %}
      **Input Names:**
      {% for i in range(1, 9) %}
      {{ i }}: {{ input_names[i|string] }}{% if not loop.last %}, {% endif %}
      {% endfor %}
      
      **Output Names:**
      {% for i in range(1, 9) %}
      {{ i }}: {{ output_names[i|string] }}{% if not loop.last %}, {% endif %}
      {% endfor %}
      {% else %}
      _Loading names from matrix..._
      {% endif %}

  # Preset Scripts
  - type: entities
    title: Quick Presets
    show_header_toggle: false
    entities:
      - entity: script.matrix_default_routing
        name: Default 1:1 Routing
        icon: mdi:restore
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.matrix_default_routing
      - entity: script.matrix_all_to_input_1
        name: All to Input 1
        icon: mdi:numeric-1-box-multiple
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.matrix_all_to_input_1
      - entity: script.matrix_gaming_preset
        name: Gaming Preset
        icon: mdi:gamepad-variant
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.matrix_gaming_preset
      - entity: script.matrix_movie_preset
        name: Movie Preset
        icon: mdi:movie-open
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.matrix_movie_preset
      - entity: script.matrix_sports_preset
        name: Sports Preset
        icon: mdi:basketball
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.matrix_sports_preset
